## Interesting Moments

- **SwapSuggestions: Sets vs Arrays** — While wiring `accept`, I confirmed Mongo’s array matching breaks the spec’s set semantics and that differing element order would silently produce duplicates. I documented the mismatch and deferred normalization until we can agree on either deterministic sorting or true set storage. [Snapshot](../../context/design/concepts/SwapSuggestions/implementation.md/steps/response.faf8bdaa.md)
- **SwapSuggestions: Test Isolation** — Running the suite uncovered leaked Mongo sockets and inconsistent results because each test reused the same database handle. The snapshot captures how those leaks manifested and why isolating `testDb()` per case is now a standing action item. [Snapshot](../../context/design/concepts/SwapSuggestions/testing.md/steps/response.6c47249a.md)
- **MealLog: Connection Lifecycle** — The initial connect/disconnect path left `mealsCollection` undefined if actions fired before `connect()` finished, causing sporadic runtime failures. I refactored the lifecycle to guarantee initialization and recorded the rationale to keep future refactors honest. [Snapshot](../../context/design/concepts/MealLog/implementation.md/steps/response.9f4979a0.md)
- **InsightMining: Deterministic Insights** — Duplicate insight rows kept appearing because identical signal sets hashed differently depending on order. The snapshot explains how `createInsightKey` now sorts signals, anchors the aggregation, and underpins deterministic report math. [Snapshot](../../context/design/concepts/InsightMining/implementation.md/steps/file.24a42d4b.md)
- **PersonalQA: Relevance Filter** — Early runs matched every short token, so questions like “to?” returned arbitrary citations. I tightened the tokenizer to drop punctuation and enforce a three-character minimum, documenting the change so future relevance tweaks have a baseline. [Snapshot](../../context/design/concepts/PersonalQA/implementation.md/steps/_.d72bfb53.md)
- **QuickCheckIns: Defensive Tests** — The negative-path suite now hits duplicate metrics, unauthorized edits, and no-op updates, which previously slipped through manual testing. I saved the improved coverage to remind us that even lightweight concepts deserve adversarial regression guards. [Snapshot](../../context/design/concepts/QuickCheckIns/testing.md/steps/file.e81b4071.md)
